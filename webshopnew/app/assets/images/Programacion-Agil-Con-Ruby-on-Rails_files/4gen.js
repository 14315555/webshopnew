var defaultViewManager="scroll";var adjacentLoadPages=3;var adjacentFontLoadPages=8;var ie6_pngfix_shim="/images/4gen/trans_1x1.gif";var pagePadding=30;var extrasWidth=315;var fontLoaderStrategy;var FONT_LOADER_EOT=1;var FONT_LOADER_CSS_TTF=2;var FONT_LOADER_MULTI_SVG=3;var FONT_SERV_VERSION=12;if(!window.console){window.console={log:function(){}}}var DocumentManager=(function(){var o={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(F){var D="";var M,K,I;var L,J,H,G;var E=0;F=F.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(E<F.length){L=this._keyStr.indexOf(F.charAt(E++));J=this._keyStr.indexOf(F.charAt(E++));H=this._keyStr.indexOf(F.charAt(E++));G=this._keyStr.indexOf(F.charAt(E++));M=(L<<2)|(J>>4);K=((J&15)<<4)|(H>>2);I=((H&3)<<6)|G;D=D+String.fromCharCode(M);if(H!=64){D=D+String.fromCharCode(K)}if(G!=64){D=D+String.fromCharCode(I)}}D=o._utf8_decode(D);return D},_utf8_decode:function(D){var E="";var G=0;var I=0;var H=0;var F=0;while(G<D.length){I=D.charCodeAt(G);if(I<128){E+=String.fromCharCode(I);G++}else{if((I>191)&&(I<224)){F=D.charCodeAt(G+1);E+=String.fromCharCode(((I&31)<<6)|(F&63));G+=2}else{F=D.charCodeAt(G+1);c3=D.charCodeAt(G+2);E+=String.fromCharCode(((I&15)<<12)|((F&63)<<6)|(c3&63));G+=3}}}return E}};function h(D){}h.prototype.initEventHelper=function(){this.eventListenerEnabled=true;this.eventListeners={};for(var D=0;D<this.possibleEvents.length;D++){this.eventListeners[this.possibleEvents[D]]={}}};h.prototype.addEvent=function(D,E){if(!this.eventListeners[D]){throw D+" is not a valid type of event"}if(!this.eventListeners[D].next_uid){this.eventListeners[D].next_uid=1}if(!E._event_listener_uid){E._event_listener_uid=this.eventListeners[D].next_uid;this.eventListeners[D].next_uid++}this.eventListeners[D][E._event_listener_uid]=E};h.prototype.removeEvent=function(D,E){delete this.eventListeners[D][E._event_listener_uid]};h.prototype.fireEvent=function(G,H){if(!this.eventListenerEnabled){return}var D=this.eventListeners[G];var E=[];if(arguments.length>1){E[arguments.length-2]=null;for(var I=1;I<arguments.length;I++){E[I-1]=arguments[I]}}var F=this;function J(L){L.apply(F,E)}for(var K in D){if(K!="next_uid"&&D.hasOwnProperty(K)){J(D[K])}}};function m(E,D){E.prototype.addEvent=h.prototype.addEvent;E.prototype.removeEvent=h.prototype.removeEvent;E.prototype.fireEvent=h.prototype.fireEvent;E.prototype.initEventHelper=h.prototype.initEventHelper;E.prototype.possibleEvents=D}var i="font_preload_bed";var d="\uF8FF";var C=function(){return !document.styleSheets[0].insertRule};var p=function(D,E){if(C()){var F=D.innerHTML;D.href=E;if(D.innerHTML!=F){D.innerHTML=F}}else{D.href=E}};var g=(function(){var D=navigator.userAgent.toLowerCase();return D.search("android 2.2")>-1})();var e=(function(){var D=navigator.userAgent.toLowerCase();return(D.search("mobile")>-1&&D.search("safari")>-1&&!g)})();var w=navigator.userAgent.indexOf("AppleWebKit/")>-1;fontLoaderStrategy=(function(){if(C()){return FONT_LOADER_EOT}else{if(e){return FONT_LOADER_CSS_TTF}else{return FONT_LOADER_CSS_TTF}}})();if(C()){adjacentFontLoadPages=5;adjacentLoadPages=2}if(g){adjacentFontLoadPages=1;adjacentLoadPages=1}function A(I,G,E,H,F,D){this.id=I;this.shortstyle=G;this.family=E;this.fallback=H;this.weight=F;this.style=D}A.prototype.eotCssRule=function(D){var E="src: url("+D+this.family+".eot); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+E+"}"};A.prototype.ttfCssRule=function(D){var E="src: url("+D+this.family+".ttf) format('truetype'); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+E+"}"};A.prototype.svgCssRule=function(D){var E="src: url("+D+"#"+this.family+") format('svg'); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+E+"}"};A.prototype.createPreloadElem=function(){return"<span style='font-family: "+this.family+"'>scribd.</span> "};function x(D){this.fonts=[];this.docManager=D;this._cssRuleQueue=[];this._fontLoadQueue=[]}x.prototype._makeNewStyleBlock=function(){var E=document.createElement("style");if(!window.createPopup){E.appendChild(document.createTextNode(""))}var D=document.getElementsByTagName("head")[0];D.appendChild(E);return E};x.prototype._insertCssRule=function(D){this._cssRuleQueue.push(D)};x.prototype._flushCssRuleQueue=function(F){if(this._cssRuleQueue.length>0){var E=(F&&document.getElementById(F))||this._makeNewStyleBlock();var D=this._cssRuleQueue.join("\n");if(C()){E.styleSheet.cssText=D}else{if(!window.createPopup){E.appendChild(document.createTextNode(D))}else{E.innerHTML=D}}this._cssRuleQueue=[]}};x.prototype.getFontAggregatorHostForFonts=function(G){var F=[];for(var E=0;E<G.length;E++){F.push(G[E].shortstyle+G[E].id)}F.sort();var D=this.docManager.nextFontAggregatorHost()+"/"+this.docManager.assetPrefix+"/"+F.join(",")+"/"+FONT_SERV_VERSION+"/";switch(fontLoaderStrategy){case FONT_LOADER_EOT:break;case FONT_LOADER_CSS_TTF:if(!g){D+="ttfs.css"}break;case FONT_LOADER_MULTI_SVG:D+="fonts.svg";break}return D};x.prototype._addTTFRules=function(G,E){for(var F=0;F<G.length;F++){var D=G[F];this._insertCssRule(D.ttfCssRule(E))}};x.prototype._addSVGRules=function(G,E){for(var F=0;F<G.length;F++){var D=G[F];this._insertCssRule(D.svgCssRule(E))}};x.prototype._addEOTRules=function(G,E){for(var F=0;F<G.length;F++){var D=G[F];this._insertCssRule(D.eotCssRule(E))}};x.prototype._nextPreloadId=function(){if(!this._preloadId){this._preloadId=0}var D="preload_bed"+this._preloadId;this._preloadId+=1;return D};x.prototype._addCSSWebkit=function(K,E){var N=this;var H=document.createElement("iframe");function O(){var P=document.createElement("div");var Q=N._nextPreloadId();P.innerHTML=L;var R=document.getElementById(i);var S=window.setInterval(function(){if(H.contentDocument.styleSheets.length>0){window.clearInterval(S);H.contentDocument.body.getBoundingClientRect();R.appendChild(P);window.setTimeout(function(){H.contentDocument.body.getBoundingClientRect();N._addCSSLink(E)},500)}},0)}var M=this._nextPreloadId();H.id=M;var L="";for(var G=0;G<K.length;G++){var D=K[G];L+=D.createPreloadElem()}var F=this._makeNewStyleBlock();H.addEventListener("load",function(){O()},false);H.style.display="none";document.body.appendChild(H);H.contentDocument.body.innerHTML=L;var J=H.contentDocument.createElement("link");J.href=E;J.rel="stylesheet";J.type="text/css";J.media="screen";var I=H.contentDocument.getElementsByTagName("head")[0];I.appendChild(J)};x.prototype._addCSSLink=function(D){var F=document.createElement("link");F.href=D;F.rel="stylesheet";F.type="text/css";var E=document.getElementsByTagName("head")[0];E.appendChild(F)};x.prototype.flushFontQueue=function(){if(this._fontLoadQueue.length===0){return}if(this.docManager.displayType=="rasterize"){return}var D=this._fontLoadQueue;this._fontLoadQueue=[];var E=this.getFontAggregatorHostForFonts(D);switch(fontLoaderStrategy){case FONT_LOADER_EOT:this._addEOTRules(D,E);break;case FONT_LOADER_CSS_TTF:if(g){this._addTTFRules(D,E)}else{if(w){this._addCSSWebkit(D,E)}else{this._addCSSLink(E)}}break;case FONT_LOADER_MULTI_SVG:this._addSVGRules(D,E);break}this._flushCssRuleQueue()};x.prototype.addFontToQueue=function(E){var D=this.fonts[E];if(!D._loadQueued){D._loadQueued=true;this._fontLoadQueue.push(D)}};x.prototype.addFont=function(J,H,F,I,G,E){var D=new A(J,H,F,I,G,E);this.fonts[J]=D};x.prototype.setNumFonts=function(D){for(var E=0;E<D;E++){this.fonts[E]=new A(E,"","ff"+E,"sans-serif","normal","normal")}};x.prototype._initHidersCSS=function(){var D=[];for(var E=0;E<this.fonts.length;E++){D.push("."+this.fonts[E].family)}this._insertCssRule(D.join(", ")+" {display: none;}\n")};x.prototype._initFamilyCSS=function(){for(var E=0;E<this.fonts.length;E++){var G=this.fonts[E].family;var I=this.fonts[E].fallback;var H=this.fonts[E].weight;var F=this.fonts[E].style;var D="div."+G+" span";if(typeof(scribd)!=="undefined"&&typeof(scribd.embed_div_id)!=="undefined"){D="#"+scribd.embed_div_id+" "+D}if(C()){this._insertCssRule(D+" {font-family: "+G+" !important;\n}")}else{this._insertCssRule(D+" {font-family: "+G+", "+I+"; font-weight: "+H+"; font-style: "+F+";\n}")}}};x.prototype.initStyles=function(D){if(this.docManager.displayType=="rasterize"){return}this._initFamilyCSS();switch(fontLoaderStrategy){case FONT_LOADER_EOT:break;case FONT_LOADER_CSS_TTF:if(!g){this._initHidersCSS()}break;case FONT_LOADER_MULTI_SVG:break}this._flushCssRuleQueue("preload_styler")};x.prototype.setupTestElements=function(){if(fontLoaderStrategy!=FONT_LOADER_CSS_TTF||w||this.docManager.displayType=="rasterize"){return}var G="";for(var F=0;F<this.fonts.length;F++){var D=this.fonts[F];G+=D.createPreloadElem()}var E=document.getElementById(i);E.innerHTML=G;document.body.appendChild(E);this._insertCssRule("#"+i+" span {display: block; visibility: hidden}");this._flushCssRuleQueue()};function a(D,E){this.pages=[];this.loaded=false;this.fonts={};this.numFonts=0;this.fontLoader=E;this.groupNum=D||0}a.prototype.addPage=function(F){for(var E=0;E<F.fonts.length;E++){var D=F.fonts[E];if(this.fonts[D]===undefined){this.fonts[D]=true;this.numFonts+=1}}this.pages.push(F)};a.prototype.isFull=function(){var F=this.pages.length;var E=this.groupNum;var D=this.numFonts;if(fontLoaderStrategy==FONT_LOADER_EOT){return(this.hasLoaded||D>50||(D>=20&&((E===0&&F>=adjacentFontLoadPages+3)||(F>=15))))}else{if(fontLoaderStrategy==FONT_LOADER_MULTI_SVG||g){return(this.hasLoaded||(D>=5&&F>=adjacentFontLoadPages))}else{return(this.hasLoaded||D>100||(D>=20&&((E===0&&F>=adjacentFontLoadPages+3)||(F>=100))))}}};a.prototype.load=function(E){if(this.hasLoaded){return}this.hasLoaded=true;var D=this;function F(){for(var G in D.fonts){if(D.fonts.hasOwnProperty(G)){D.fontLoader.addFontToQueue(G)}}D.fontLoader.flushFontQueue()}if(E){window.setTimeout(function(){F()},E)}else{F()}};a.prototype.newNextGroup=function(){return new a(this.groupNum+1,this.fontLoader)};var q=1;var z=2;var b=3;var y=4;var r=(function(){if(document.documentElement.style.WebkitTransform!==undefined){return q}else{if(document.documentElement.style.MozTransform!==undefined){return z}else{if(document.documentElement.style.OTransform!==undefined){return y}else{return b}}}})();function l(G){for(var E in this._defaultParams){if(this._defaultParams.hasOwnProperty(E)){this[E]=G[E]||this._defaultParams[E]}}for(var D=0;D<this._requiredParams.length;D++){var F=this._requiredParams[D];if(!this[F]){throw"Missing required Page param: "+F}}if(!this.contentUrl&&!this.innerPageElem){throw"Must initialize a page with either a contentUrl or innerPageElem element"}if(this.containerElem.boundToPageObj===true){throw"Container Elem is already bound to a page.  We shouldn't get here"}this.containerElem.boundToPageObj=true;this._targetWidth=null;this._innerPageVisible=!!this.innerPageElem;this._imagesTurnedOn=false;this.boundingRect=null;this.isVisible=false;this.displayDirty=true;this.displayOn=null;this.loadHasStarted=!!this.innerPageElem}l.prototype._defaultParams={containerElem:null,innerPageElem:null,contentUrl:null,origWidth:null,origHeight:null,fonts:null,docManager:null,pageNum:null};l.prototype._requiredParams=["origWidth","origHeight","fonts","docManager","containerElem","pageNum"];l.prototype._updateBoundingRect=function(){var I,H,G,E;if(this.containerElem.getBoundingClientRect){var F=this.containerElem.getBoundingClientRect();var D=this.docManager.viewportManager.viewRect;H=F.left+D.left;I=F.top+D.top;G=F.right-F.left;E=F.bottom-F.top;this.boundingRect={left:H,top:I,bottom:I+E,right:H+G,width:G,height:E}}else{I=this.containerElem.offsetTop;H=this.containerElem.offsetLeft;G=this.containerElem.offsetWidth;E=this.containerElem.offsetHeight;this.boundingRect={left:H,top:I,bottom:I+E,right:H+G,width:G,height:E}}};l.prototype._setContainerContents=function(F){var E=/<noscript *><img[^<>]*\/><\/noscript *>/g;this.containerElem.innerHTML=F.replace(E,"")+this.containerElem.innerHTML;var D=this;this.innerPageElem=this.containerElem.children[0];this.turnOnLinks();this.turnOnImages();this.fixSVGFonts();this.displayDirty=true;if(this.displayOn){this.display()}else{this.hide()}};l.prototype.fixSVGFonts=function(){if(this._svgFontsFixed){throw"Already fixed the svg fonts"}if(!this.innerPageElem){return}if(e){var E=function(I){if(I.nodeType==document.TEXT_NODE){var F=I.textContent.search(/[  \n][^ \n ]/);if(F>=0){E(I.splitText(F+1))}}else{var H=I.childNodes;for(var G=0;G<H.length;G++){E(H[G])}}};var D=function(H){var G=H.childNodes;for(var F=0;F<G.length;F++){var J=G[F];if(J.nodeType==document.ELEMENT_NODE){D(J)}else{var I=G[F+1];if(I&&I.nodeName=="#text"){H.insertBefore(document.createElement("span"),I)}}}};E(this.innerPageElem);D(this.innerPageElem)}this._svgFontsFixed=true};l.prototype.imagePageContent=function(D){str="<img src='"+D+"'></img>";return str};l.prototype.load=function(){this.currentlyLoading=true;this.loadHasStarted=true;if(this.innerPageElem){throw"We already have loaded this page, but it looks like you called loadPage again"}this.loadFonts();var G="page"+this.pageNum+"_callback";if(window[G]){try{delete window[G]}catch(F){window[G]=undefined}}if(this.docManager.displayType=="rasterize"){delete this.currentlyLoading;this._setContainerContents(this.imagePageContent(this.contentUrl));return}var E=document.createElement("script");var D=this;window[G]=function(I){document.body.removeChild(E);var J=I[0];delete D.currentlyLoading;D._setContainerContents(J);D.docManager.fireEvent("pageLoaded",D.containerElem);try{delete window[G]}catch(H){window[G]=undefined}};E.src=this.contentUrl;E.type="text/javascript";E.charset="UTF-8";document.body.appendChild(E)};l.prototype.remove=function(){if(this.innerPageElem){var D=this.innerPageElem.parentNode;D.removeChild(this.innerPageElem);delete this.innerPageElem;delete this.currentLoading;delete this.loadHasStarted;this._linksTurnedOn=false;this._imagesTurnedOn=false;this._svgFontsFixed=false}};l.prototype.display=function(E,D){if(this.displayOn&&!this.displayDirty){return}this.displayOn=true;if(this.currentlyLoading){return}else{if(!this.innerPageElem){if(this.loadHasStarted){return}else{if(E){this.load();return}else{return}}}}this.displayDirty=false;if(!D){if(!this._linksTurnedOn){this.turnOnLinks()}if(!this._imagesTurnedOn){this.turnOnImages()}if(!this._svgFontsFixed){this.fixSVGFonts()}}this.loadFonts();if(this._innerPageVisible){return}this.containerElem.className=this.containerElem.className.replace(/placeholder|not_visible/g,"");this._innerPageVisible=true;if(!D){this._fitContentsToWidth();this.innerPageElem.style.display="block"}};l.prototype.hide=function(){if(!this.displayOn&&!this.displayDirty){return}this.displayOn=false;if(!this.innerPageElem){return}this.displayDirty=false;this.containerElem.className=this.containerElem.className+" not_visible";this._innerPageVisible=false;this.innerPageElem.style.display="none"};l.prototype.setLoadFontGroup=function(D){D.addPage(this);this.loadFontGroup=D};l.prototype.loadFonts=function(){this.loadFontGroup.load()};var n=!!(document.all&&(/msie 6./i).test(navigator.appVersion)&&window.ActiveXObject);l.prototype._setZoomScale=function(F){var E=this.innerPageElem;switch(r){case q:E.style.WebkitTransform="scale("+F+")";E.style.WebkitTransformOrigin="top left";break;case z:E.style.MozTransform="scale("+F+")";E.style.MozTransformOrigin="top left";break;case y:E.style.OTransform="scale("+F+")";E.style.OTransformOrigin="top left";break;case b:if(!E.originalZoom){E.originalZoom=E.currentStyle.zoom=="normal"?1:parseFloat(E.currentStyle.zoom)/100;if(n&&!this.docManager._isEmbed){E.originalZoom*=1.35}}E.style.zoom=(E.originalZoom*F*100)+"%";if(n){var D=this.innerPageElem;setTimeout(function(){D.style.marginLeft=D.style.marginLeft===""?0:""},500)}break;default:throw"Unknown scale method "+r}};l.prototype._fitContentsToWidth=function(){if(this._targetWidth&&this.innerPageElem&&this._innerPageVisible){var D=this._targetWidth/this.origWidth;this._setZoomScale(D);this._targetWidth=null}};l.prototype.setWidth=function(E){var D=Math.ceil((E/this.origWidth)*this.origHeight);this.containerElem.style.width=E+"px";this.containerElem.style.height=D+"px";this._targetWidth=E;this._fitContentsToWidth()};l.prototype.setBounds=function(E,D){if(this.origWidth/this.origHeight>E/D){D=Math.ceil((E/this.origWidth)*this.origHeight)}else{E=Math.ceil((D/this.origHeight)*this.origWidth)}this.containerElem.style.width=E+"px";this.containerElem.style.height=D+"px";this._targetWidth=E;this._fitContentsToWidth()};l.prototype.turnOnImages=function(){if(!this.innerPageElem){throw"Can't turn on images for a page that's not loaded"}if(this._imagesTurnedOn){throw"Images have already been turned on for this document"}this._imagesTurnedOn=true;var F=this.innerPageElem.getElementsByTagName("img");for(var E=0;E<F.length;E++){var D=F[E];if(D.className.toLowerCase().search("absimg")>-1){if(!D.src){var G=this.docManager.subImageSrc(D.getAttribute("orig"));if(this.docManager.enablePNGHack){D.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+G+"', sizingMethod='scale')";D.src=ie6_pngfix_shim}else{D.src=G}D.removeAttribute("orig");D.style.display="block"}}}};l.prototype.turnOnLinks=function(){if(!this.innerPageElem){throw"Can't turn on links for a page that's not loaded"}if(this._linksTurnedOn){throw"Links have already been turned on for this document"}this._linksTurnedOn=true;function E(J){return(function(){window.location.hash="#outer_page_"+J.substring(4)})}var H=this.innerPageElem.getElementsByTagName("a");for(var G=0;G<H.length;G++){var D=H[G];if(D.className.toLowerCase().search("ll")>-1){if(!D.href){var I=D.getAttribute("orig");if(I){var F=o.decode(I).replace(/^j[\W]*a[\W]*v[\W]*a[\W]*s[\W]*c[\W]*r[\W]*i[\W]*p[\W]*t[\W]*:|^f[\W]*i[\W]*l[\W]*e[\W]*:/ig,"");if(F.search(/^page/)>-1){D.onclick=E(F)}else{if(F.search(/^mailto:/)>=0){}else{if(F.search(/^(http|ftp)/)<0){F="http://"+F}}D.target="_blank";p(D,F);D.rel="nofollow"}}}}}};function v(){this.initEventHelper();this.viewRect=null;this.enabled=false;var D=this;this._scrollCallback=function(){D._eventHandler("scroll")};this._resizeCallback=function(E){D._eventHandler("resize")}}m(v,["vertical","horizontal","either","resize"]);v.prototype._makeViewRect=function(){var J=document.documentElement;var I=window.scrollY||window.pageYOffset||J.scrollTop;var H=window.scrollX||window.pageXOffset||J.scrollLeft;var G=window.innerWidth||J.clientWidth;var D=window.innerHeight||J.clientHeight;var F=H+G;var E=I+D;return{top:I,left:H,right:F,bottom:E,width:G,height:D}};v.prototype._updateViewRect=function(){var F=this.viewRect;this.viewRect=this._makeViewRect();var E=!F||F.left!=this.viewRect.left||F.width!=this.viewRect.width;var D=!F||F.top!=this.viewRect.top||F.height!=this.viewRect.height;return{xChanged:E,yChanged:D}};v.prototype._eventHandler=function(D){var E=this._updateViewRect();if((D=="resize"||D=="both")&&(E.xChanged||E.yChanged)){this.fireEvent("resize",this.viewRect)}if(E.xChanged||E.yChanged){this.fireEvent("either",this.viewRect)}if(E.xChanged){this.fireEvent("horizontal",this.viewRect)}if(E.yChanged){this.fireEvent("vertical",this.viewRect)}};v.prototype.enable=function(){if(this.enabled){throw"ViewportManager has already been enabled"}this.enabled=true;this.container=window;this._eventHandler("both");if(window.addEventListener){window.addEventListener("resize",this._resizeCallback,false);window.document.addEventListener("scroll",this._scrollCallback,false)}else{if(window.attachEvent){window.attachEvent("onresize",this._resizeCallback);window.attachEvent("onscroll",this._scrollCallback)}}};v.prototype.disable=function(){if(!this.enabled){throw"ViewportManager is already been enabled"}this.enabled=false;if(this.container.removeEventListener){window.removeEventListener("resize",this._resizeCallback,false);this.container.removeEventListener("scroll",this._scrollCallback,false)}else{if(window.detatchEvent){window.detatchEvent("onresize",this._resizeCallback);this.container.detatchEvent("onscroll",this._scrollCallback)}}};function u(){}u.prototype.name=function(){return this._name};u.prototype.register=function(E,D){if(this.registered){throw"This ViewManager is already registered"}this.registered=true;this.documentManager=E;this.viewportManager=D;this._currentPageWidth=defaultViewWidth;this._currentZoomMultiplier=1;this._updatePageWidths();var F=this.documentManager.firstVisiblePage;this._register(E,D);if(F){this.documentManager.gotoPage(F.pageNum,{pretty:false})}};u.prototype._zoomedPageWidth=function(){return this._currentPageWidth*this._currentZoomMultiplier};u.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth())};u.prototype.isTopPageInView=function(){return true};u.prototype._register=function(E,D){};u.prototype.unregister=function(){if(!this.registered){throw"This ViewManager is already unregistered"}if(this.isFullscreen){this.exitFullscreen()}this._checkBodyWidth();this._unregister();this.registered=false;delete this.documentManager;delete this.viewportManager};u.prototype._unregister=function(){};u.prototype._pagingStep=function(){return 1};u.prototype.gotoPage=function(E,D){if(!this.registered){throw"ViewManager must be registerd to call gotoPage"}this._gotoPage(E,D)};u.prototype._gotoPage=function(E,D){};u.prototype._fireHideExtras=function(){this.documentManager._fireHideExtras();this._extrasHidden=true};u.prototype._fireShowExtras=function(){this.documentManager._fireShowExtras();this._extrasHidden=false};u.prototype.enterFullscreen=function(){if(this.isFullscreen){throw"Fullscreen is already set"}this._checkBodyWidth();this.viewportManager.addEvent("resize",this._fullscreenResizedCallback);this._fireHideExtras();this.resetZoom();this._enterFullscreen();this._fullscreenResized(this.viewportManager.viewRect);this._currentPageWidth=this.viewportManager.viewRect.width;this.isFullscreen=true;var D=this.documentManager.firstVisiblePage;if(D){this.documentManager.gotoPage(D.pageNum,{pretty:false})}this.documentManager._fireEnteredFullscreen()};u.prototype.exitFullscreen=function(){if(!this.isFullscreen){throw"Fullscreen is not set"}this.viewportManager.removeEvent("resize",this._fullscreenResizedCallback);this._fireShowExtras();this.resetZoom();this._exitFullscreen();this.isFullscreen=false;var D=this.documentManager.firstVisiblePage;if(D){this.documentManager.gotoPage(D.pageNum,{pretty:false})}this.documentManager._fireExitedFullscreen()};u.prototype._viewBarWidth=function(){if(this._extrasHidden){return 0}else{return this.documentManager.options.extrasWidth}};u.prototype._enterFullscreen=function(){};u.prototype._exitFullscreen=function(){};u.prototype._fullscreenResized=function(D){};u.prototype._scrollWithZoom=function(D,E){window.scrollTo(0,D.top*E)};u.prototype.zoom=function(E){var D=this.viewportManager.viewRect;this._currentZoomMultiplier*=E;this._checkBodyWidth();this._updatePageWidths();this.documentManager.setIsScrolling(true);this._scrollWithZoom(D,E);this._zoomed();this.documentManager.setIsScrolling(false);this.documentManager._fireZoomed(E)};u.prototype._zoomed=function(){};u.prototype.resetZoom=function(){this._currentZoomMultiplier=1;this._checkBodyWidth();this._updatePageWidths();this._zoomed()};u.prototype._checkBodyWidth=function(D){var F=document.documentElement.clientWidth;var E=this._zoomedPageWidth()+this._viewBarWidth()+10;globalHeader=document.getElementById("global_header");if(E>F){document.body.style.width=E+"px";if(globalHeader){globalHeader.style.width=F+"px"}}else{document.body.style.width="100%";if(globalHeader){globalHeader.style.width="100%"}}};function B(F,E,G){if(typeof(scribd)!=="undefined"&&typeof(scribd.jQuery)!=="undefined"){(function(H){H("html, body").animate({scrollTop:H(F).offset().top},{queue:false,duration:E,easing:"linear",complete:G})})(scribd.jQuery)}else{if(window.Effect){var D={duration:E/1000,fps:100,transition:Effect.Transitions.linear,afterFinish:G};return new Effect.ScrollTo(F,D)}}}function j(){this._name="book";this.currentPageId=null;var D=this;this._fullscreenResizedCallback=function(E){D._fullscreenResized(E)}}j.prototype=new u();j.prototype._register=function(E,D){this._prepareDisplay()};j.prototype._unregister=function(){for(var D in this.documentManager.pages){if(this.documentManager.pages.hasOwnProperty(D)){var E=this.documentManager.pages[D];E.containerElem.removeClassName("book_view");E.containerElem.style.display=""}}};j.prototype._prepareDisplay=function(){for(var D in this.documentManager.pages){if(this.documentManager.pages.hasOwnProperty(D)){var E=this.documentManager.pages[D];E.containerElem.addClassName("book_view");E.containerElem.style.display="none";E.hide()}}this.documentManager.setPageMissingModulesVisible(false);this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)};j.prototype._zoomed=function(){var D=this.documentManager.pages[this.currentPageId]};j.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth()/2)};j.prototype._pagingStep=function(){return 2};j.prototype._showPage=function(D){var E=this.documentManager.pages[D];if(E){E.isVisible=true;E.display(true);E.containerElem.style.display=""}};j.prototype._hidePage=function(D){var E=this.documentManager.pages[D];if(E){E.isVisible=false;E.containerElem.style.display="none";E.hide()}};j.prototype._gotoPage=function(E,G){if(E%2==1){E-=1}var D=null;var F=null;if(typeof(this.currentPageId)=="number"){this._hidePage(this.currentPageId);this._hidePage(this.currentPageId+1)}D=this.documentManager.pages[E];F=this.documentManager.pages[E+1];if(!D&&!F){return}this.currentPageId=E;if(this.isFullscreen){this._setPageBounds(this.viewportManager.viewRect)}this._showPage(E);this._showPage(E+1);this.documentManager.visiblePagesChanged()};j.prototype._setWidth=function(D){this._currentPageWidth=D;this.documentManager.setPageWidths(D)};j.prototype._fullscreenResized=function(D){this._setWidth(D.width-pagePadding)};j.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth;B(this.documentManager.pages[this.currentPageId].containerElem,300)};j.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth);this._checkBodyWidth()};function t(){this._name="slideshow";this.currentPageId=null;var D=this;this._fullscreenResizedCallback=function(E){D._fullscreenResized(E)}}t.prototype=new u();t.prototype._register=function(E,D){this._prepareDisplay();var F=document.getElementById("scroll_preventer");if(F){F.style.overflow="hidden";F.style.height="100%"}};t.prototype._unregister=function(){var D=document.getElementById("scroll_preventer");if(D){D.style.overflow="visible";D.style.height="auto"}};t.prototype._prepareDisplay=function(){for(var D in this.documentManager.pages){if(this.documentManager.pages.hasOwnProperty(D)){var E=this.documentManager.pages[D];E.containerElem.style.display="none";E.hide()}}this.documentManager.setPageMissingModulesVisible(false);this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)};t.prototype._setPageBounds=function(D){var E=this.documentManager.pages[this.currentPageId];if(E){E.setBounds(D.width,D.height)}};t.prototype._gotoPage=function(D,E){if(!this.documentManager.pages.hasOwnProperty(D)){return}var F;if(this.currentPageId){F=this.documentManager.pages[this.currentPageId];if(F){F.isVisible=false;F.containerElem.style.display="none";F.hide()}}this.currentPageId=D;F=this.documentManager.pages[D];if(this.isFullscreen){this._setPageBounds(this.viewportManager.viewRect)}F.isVisible=true;F.display(true);F.containerElem.style.display="";this.documentManager.visiblePagesChanged()};t.prototype._setWidth=function(D){this._currentPageWidth=D;this.documentManager.setPageWidths(D)};t.prototype._fullscreenResized=function(D){this._setPageBounds(D)};t.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth;B(this.documentManager.pages[this.currentPageId].containerElem,300)};t.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth);this._checkBodyWidth()};function c(){this._name="scroll";var D=this;this._verticalPositionChangeCallback=function(){D._verticalPositionChanged()};this._fullscreenResizedCallback=function(){D._fullscreenResized()}}c.prototype=new u();c.prototype._updateInViewport=function(F){var D=this.viewportManager.viewRect;var E=F.boundingRect;var G=F.isVisible;if(!D||!E){F.isVisible=false}else{F.isVisible=(E.left<D.right&&E.right>D.left&&E.top<D.bottom&&E.bottom>D.top)}this.adjacentVisiblePages=2;return G!=F.isVisible};c.prototype._verticalPositionChanged=function(){var E=false;for(var G in this.pages){if(this.pages.hasOwnProperty(G)){var F=this.pages[G];var D=this._updateInViewport(F);E=E||D}}if(E){this.documentManager.visiblePagesChanged()}else{this.documentManager.scheduleLogPageView()}this._updateDisplayOnPages()};c.prototype._updateDisplayOnPages=function(){if(this.documentManager.firstVisiblePage&&this.documentManager.lastVisiblePage){var G=this.documentManager.firstVisiblePage.pageNum-this.adjacentVisiblePages;var F=this.documentManager.lastVisiblePage.pageNum+this.adjacentVisiblePages;for(var E in this.pages){if(this.pages.hasOwnProperty(E)){var D=this.pages[E];if(D){if(D.pageNum>=G&&D.pageNum<=F){D.display()}else{D.hide();this.documentManager.fireEvent("pageHide",D)}}}}}};c.prototype._zoomed=function(){this._verticalPositionChanged()};c.prototype._register=function(G,E){this.pages=G.pages;this.viewportManager.addEvent("vertical",this._verticalPositionChangeCallback);for(var D in this.pages){if(this.pages.hasOwnProperty(D)){var F=this.documentManager.pages[D];F.containerElem.style.display=""}}this.documentManager.setPageMissingModulesVisible(true);this.documentManager._updatePageBoundingRects();this._verticalPositionChanged()};c.prototype.isTopPageInView=function(){var D=this.documentManager.firstVisiblePage;if(D){if(this.documentManager._expectedFirstPageNum>D.pageNum){return true}return D.boundingRect.top+5>=this.viewportManager.viewRect.top}else{return true}};c.prototype._unregister=function(){this.viewportManager.removeEvent("vertical",this._verticalPositionChangeCallback);delete this.pages};c.prototype._gotoPage=function(E,F){if(!this.pages.hasOwnProperty(E)){return}var G=this.documentManager.pages[E];if(F.pretty){this.documentManager.setIsScrolling(true);var D=this;this._scrollEffect=B(G.containerElem,300,function(){D.documentManager.setIsScrolling(false);if(!D.isScrolling){D.documentManager.visiblePagesChanged();delete D._scrollEffect}})}else{this.documentManager.setIsScrolling(true);G._updateBoundingRect();scrollTo(G.boundingRect.left,G.boundingRect.top);this.documentManager.setIsScrolling(false);this.documentManager.visiblePagesChanged()}return G.pageNum};c.prototype._gotoNextPage=function(){if(!this.documentManager.firstVisiblePage){return}this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum+1,{direction:1})};c.prototype._gotoPreviousPage=function(){if(!this.documentManager.firstVisiblePage){return}this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum-1,{direction:-1})};c.prototype._setWidth=function(D){this._currentPageWidth=D;this._updatePageWidths();this._checkBodyWidth()};c.prototype._fullscreenResized=function(){this._setWidth((window.innerWidth||document.documentElement.clientWidth)-pagePadding)};c.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentWidth||defaultViewWidth};c.prototype._exitFullscreen=function(){this._setWidth(this._previousPageWidth)};function k(F,E,D){this.options=D||{};this.options.extrasWidth=this.options.extrasWidth||extrasWidth;this.defaultViewMode=(F||"scroll");this.mobile=(E||false);this.initEventHelper();this.pages={};this._pageWidths=null;this._fontLoader=new x(this);this.viewManagers={scroll:new c(),slideshow:new t(),book:new j()};this.viewportManager=new v();this._currentFontAggregatorHostIdx=0;this.visiblePages=[];this.firstVisiblePage=null;this.lastVisiblePage=null;this.currentFontGroup=new a(0,this._fontLoader);this.isScrolling=false;this._scrollingCount=0}m(k,["expectedFirstPageChanged","viewmodeChanged","enteredFullscreen","exitedFullscreen","hideExtras","showExtras","zoomed","pageHide","pageLoaded","allPagesAdded","pageView"]);k.prototype._fireZoomed=function(D){this.fireEvent("zoomed",D)};k.prototype.nextFontAggregatorHost=function(){this._currentFontAggregatorHostIdx=(this._currentFontAggregatorHostIdx+1)%this.fontAggregatorHosts.length;return this.fontAggregatorHosts[this._currentFontAggregatorHostIdx]};k.prototype._fireHideExtras=function(){this.fireEvent("hideExtras")};k.prototype._fireShowExtras=function(){this.fireEvent("showExtras")};k.prototype.currentPageNum=function(){return this._expectedFirstPageNum};k.prototype.setupTestElements=function(){this._fontLoader.setupTestElements()};k.prototype.pageCount=function(){if(this.hasOwnProperty("_pageCount")){return this._pageCount}var D=0;for(var E in this.pages){if(this.pages.hasOwnProperty(E)){D++}}this._pageCount=D;return this._pageCount};k.prototype.setupPaidDocument=function(F,E){this.allowedPages=F;this.originalPageCount=E;this._allowedPagesHash=[];this._maximumAllowedPage=Math.max.apply(null,this.allowedPages);this._minimumAllowedPage=Math.min.apply(null,this.allowedPages);this._isPaidDocument=true;this._pageMissingElements=[];for(var D=0;D<F.length;D++){this._allowedPagesHash[F[D]]=true;if((D>0&&F[D]>F[D-1]+1)||(D===0&&F[D]!=1)){this._pageMissingElements.push("page_missing_explanation_"+F[D].toString())}}if(this._maximumAllowedPage!=this.originalPageCount){this._pageMissingElements.push("page_missing_explanation_"+(this.originalPageCount+1).toString())}};k.prototype.minimumPageNumber=function(){if(this.viewMode()=="book"){return 0}else{return 1}};k.prototype.maximumPageNumber=function(){if(this.allowedPages){return this.originalPageCount}else{return this.pageCount()}};k.prototype.getClosestPageNumber=function(E,F){if(this.allowedPages){if(this._allowedPagesHash[E]){return E}else{if(E>=this._maximumAllowedPage){return this._maximumAllowedPage}else{if(E<=this._minimumAllowedPage){return this._minimumAllowedPage}}for(var D=1;D<=this.originalPageCount;D++){if(F<=0&&this._allowedPagesHash[E-D]===true){return E-D}else{if(F>=0&&E+D<this.originalPageCount&&this._allowedPagesHash[E+D]===true){return E+D}}}}}else{return E}};k.prototype.setPageMissingModulesVisible=function(E){if(!this._isPaidDocument){return}for(var D=0;D<this._pageMissingElements.length;D++){var F=$(this._pageMissingElements[D]);if(F){if(E){F.show()}else{F.hide()}}}};k.prototype.getNextAvailablePage=function(D){return getClosestPageNumber(D,1)};k.prototype.getPreviousAvailablePage=function(D){return getClosestPageNumber(D,-1)};k.prototype.flushFontQueue=function(){this._fontLoader.flushFontQueue()};k.prototype.visiblePagesChanged=function(){var G=[];for(var F in this.pages){if(this.pages.hasOwnProperty(F)){var E=this.pages[F];if(E.isVisible){G.push(E)}}}G.sort(function(I,H){if(I.pageNum<H.pageNum){return -1}else{return 1}});this.visiblePages=G;var D=this.firstVisiblePage;this.firstVisiblePage=G.length>0?G[0]:null;this.lastVisiblePage=G.length>0?G[G.length-1]:null;if(!this.isScrolling){this._loadAdjacentFonts();this._loadAdjacentPages()}if((this.firstVisiblePage!==D&&(!this.firstVisiblePage||!D))||this.firstVisiblePage.pageNum!=D.pageNum){if(!this.isScrolling&&this.firstVisiblePage){this._updateExpectedFirstPage(this.firstVisiblePage.pageNum)}}this.scheduleLogPageView()};function s(E,F,D){return Math.min(D,Math.max(F,E))}k.prototype.boundingRatioForPage=function(H){var D=this.viewportManager.viewRect;var F=H.boundingRect;var G=F.bottom-F.top;var E=F.right-F.left;return{left:(D.left-F.left)/E,right:(D.right-F.right)/E+1,top:s((D.top-F.top)/G+H.pageNum,H.pageNum,H.pageNum+1),bottom:s((D.bottom-F.bottom)/G+H.pageNum+1,H.pageNum,H.pageNum+1)}};k.prototype.scheduleLogPageView=function(){if(this.logPageViewTimout){window.clearTimeout(this.logPageViewTimout)}var D=this;this.logPageViewTimout=window.setTimeout(function(){D.logPageView();D.logPageViewTimout=null},1000)};function f(D){return Math.floor(D*100)/100}k.prototype.getVisibleBBox=function(){var D={};if(this.firstVisiblePage){var F=this.boundingRatioForPage(this.firstVisiblePage);D.left=F.left;D.right=F.right;D.top=F.top}if(this.lastVisiblePage){var E=this.boundingRatioForPage(this.lastVisiblePage);D.bottom=E.bottom}return D};k.prototype.logPageView=function(){var G=this.getVisibleBBox();for(var D in G){if(G.hasOwnProperty(D)){G[D]=f(G[D])}}var E=window.$rat;if(E){var F;if(window.RAT_API_VERSION=="2"){F=[[G.left,G.top],[G.right,G.bottom]]}else{F="("+G.left+" "+G.top+") ("+G.right+" "+G.bottom+")"}E("fourgen.viewchange",F)}this.fireEvent("pageView");return G};k.prototype._updateExpectedFirstPage=function(D){this._expectedFirstPageNum=D;this.fireEvent("expectedFirstPageChanged",this._expectedFirstPageNum)};k.prototype._loadAdjacentFonts=function(){if(this.firstVisiblePage&&this.lastVisiblePage){var H=[];var D=this.firstVisiblePage.pageNum-adjacentFontLoadPages;var F=this.lastVisiblePage.pageNum+adjacentFontLoadPages;for(var E=D;E<=F;E++){var G=this.pages[E];if(G){G.loadFonts()}}}};k.prototype._loadAdjacentPages=function(){if(this.firstVisiblePage&&this.lastVisiblePage){var H=[];var D=this.firstVisiblePage.pageNum-adjacentLoadPages;var F=this.lastVisiblePage.pageNum+adjacentLoadPages;for(var E=D;E<=F;E++){var G=this.pages[E];if(G&&!G.loadHasStarted){G.load();if(this.mobile){G.setWidth(this._pageWidths)}}}if(this.mobile){this._removeUnusedPages()}}};k.prototype._removeUnusedPages=function(){var E=this.firstVisiblePage.pageNum-adjacentLoadPages;var G=this.lastVisiblePage.pageNum+adjacentLoadPages;var D=this.pages;var F=adjacentLoadPages+1;while(D[F]){if(F<E||F>G){D[F].remove()}F++}};k.prototype._updatePageBoundingRects=function(){for(var D in this.pages){if(this.pages.hasOwnProperty(D)){this.pages[D]._updateBoundingRect()}}};k.prototype.addPage=function(E){if(E.pageNum===undefined){throw"must have pageNum param"}E.docManager=this;var D=new l(E);this.pages[E.pageNum]=D;if(this._pageWidths){D.setWidth(this._pageWidths)}if(this.currentFontGroup.isFull()){this.currentFontGroup=this.currentFontGroup.newNextGroup()}D.setLoadFontGroup(this.currentFontGroup);return D};k.prototype.setIsScrolling=function(D){if(D){this._scrollingCount+=1}else{this._scrollingCount-=1}if(this._scrollingCount<0){this._scrollingCount=0}if(this._scrollingCount===0){this.isScrolling=false}else{this.isScrolling=true}};k.prototype.setViewManager=function(D){if(this._currentViewManager){this._currentViewManager.unregister()}var E=this._currentViewManager;this._currentViewManager=this.viewManagers[D];this._currentViewManager.register(this,this.viewportManager);this.fireEvent("viewmodeChanged",this.viewMode(),E?E.name():null)};k.prototype.setDefaultWidth=function(D){this._currentViewManager._currentPageWidth=D;this._currentViewManager._currentZoomMultiplier=1;this._currentViewManager._updatePageWidths()};k.prototype.subImageSrc=function(F){var E,D=0;for(E=0;E<F.length;E++){D+=F.charCodeAt(E)}var G=this._imageDomainSubstitutionList[D%this._imageDomainSubstitutionList.length];return F.replace(this._imageDomainSubstitutionFrom,G)};k.prototype.allPagesAdded=function(){if(this._allPagesAddedCalled){throw"can only call allPagesAdded once"}this.viewportManager.enable();this._updatePageBoundingRects();this.setViewManager(this.defaultViewMode);this.fireEvent("allPagesAdded")};k.prototype.setEmbeddedDoc=function(D){this._isEmbed=(D==="True")};k.prototype.setPageWidths=function(D){this._pageWidths=D;for(var E in this.pages){if(this.pages.hasOwnProperty(E)){this.pages[E].setWidth(this._pageWidths)}}this._updatePageBoundingRects()};k.prototype.addFont=function(I,G,E,H,F,D){this._fontLoader.addFont(I,G,E,H,F,D)};k.prototype.setNumFonts=function(D){this._fontLoader.setNumFonts(D)};k.prototype.initStyles=function(){this._fontLoader.initStyles()};k.prototype.gotoPage=function(D,E){if(D<this.minimumPageNumber()||D>this.maximumPageNumber()){return}if(!E){E={}}if(E.pretty===undefined){E.pretty=true}var G=E.direction||0;var F=this.pages[D];if(F===undefined&&this._isPaidDocument){D=this.getClosestPageNumber(D,G);F=this.pages[D]}if(this.mobile){if(this.pages[D]){this.pages[D].setWidth(this._pageWidths)}}this._updateExpectedFirstPage(D);this._currentViewManager.gotoPage(this._expectedFirstPageNum,E)};k.prototype.gotoPreviousPage=function(){var D=this._currentViewManager._pagingStep();if(this._currentViewManager.isTopPageInView()){this.gotoPage(this._expectedFirstPageNum-D,{direction:-1})}else{this.gotoPage(this._expectedFirstPageNum,{direction:-1})}};k.prototype.gotoNextPage=function(){var D=this._currentViewManager._pagingStep();this.gotoPage(this._expectedFirstPageNum+D,{direction:1})};k.prototype.enterFullscreen=function(){this._currentViewManager.enterFullscreen()};k.prototype.exitFullscreen=function(){this._currentViewManager.exitFullscreen()};k.prototype._fireEnteredFullscreen=function(){this.fireEvent("enteredFullscreen")};k.prototype._fireExitedFullscreen=function(){this.fireEvent("exitedFullscreen")};k.prototype.viewMode=function(){if(this._currentViewManager){return this._currentViewManager.name()}return null};k.prototype.zoom=function(D){this._currentViewManager.zoom(D)};k.prototype.resetZoom=function(){this._currentViewManager.resetZoom()};k.prototype.setImageDomainSubstitution=function(D,E){this._imageDomainSubstitutionFrom=D;this._imageDomainSubstitutionList=E};k.prototype.disableViewManagerResizeWidth=function(){u.prototype._checkBodyWidth=function(){}};k.prototype.disable=function(){if(!this.disabled){this.disabled=true;this.viewportManager.disable()}};return k})();window.DocumentManager=DocumentManager;